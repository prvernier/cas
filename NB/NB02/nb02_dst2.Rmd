---  
title: "DST Attributes (layer 2)"
date: "Updated: `r format(Sys.time(), '%d %B %Y')`"
output_dir: "../docs"
output:  
  html_document:  
    code_folding: hide
    toc: true
    toc_float:
      collapsed: false
    css: "../docs/styles.css"
---  

<br>

# Overview

  * See comments under individual attribute heading

<br>

# Attributes

```{r echo=FALSE, message=FALSE, warning=FALSE}  
#x4 = read_csv("../data/NB_0001/NB_0001_fixed.lyr") # CAS04 results for comparison
#x = friConnect("nb02")
y = filter(x, src_filename=="geonb_forest-foret") # keep only forest polygons
y = filter(x, l2vs>0)
lyr = 2
```

## dist_type_1 {.tabset}

```{r echo=TRUE, message=FALSE, warning=FALSE}
friList = c("BB","CC","CL","CT","CV","FP","FT","FW","IT","PA","PB","PC","PL","PT","RC","RR","SA","SC","SH","SR","ST","TI","TP")
casList = c("BU","CO","SI","PC","PC","SI","OT","PC","PC","PC","BU","PC","SI","OT","PC","OT","PC","PC","PC","PC","PC","SI","PC")
y = mutate(y, dist_type_1=case_when(
        is.na(trt) ~ "NULL_VALUE",
        str_trim(trt)=="" ~ "EMPTY_STRING",
        !trt %in% friList ~ "NOT_IN_SET",
        TRUE ~ mapvalues(trt, friList, casList))
    )
```

### RAWFRI
```{r echo=FALSE, message=FALSE, warning=FALSE}  
dfSummary(y$trt, graph.col=FALSE, max.distinct.values=20)
```

### CASFRI
```{r echo=FALSE, message=FALSE, warning=FALSE}  
dfSummary(y$dist_type_1, graph.col=FALSE, max.distinct.values=20)
```

## dist_year_1 {.tabset}

```{r echo=TRUE, message=FALSE, warning=FALSE}
y = mutate(y, dist_year_1=case_when(
        is.na(trt) ~ as.integer(-8888),
        TRUE ~ as.integer(trtyr))
    )
```

### RAWFRI
```{r echo=FALSE, message=FALSE, warning=FALSE}  
dfSummary(y$trtyr, graph.col=FALSE, max.distinct.values=101)
```

### CASFRI
```{r echo=FALSE, message=FALSE, warning=FALSE}  
dfSummary(y$dist_year_1, graph.col=FALSE, max.distinct.values=101)
```

## dist_ext_upper_1, dist_ext_lower_1 {.tabset}

  * value = -8888 in cas04

## dist_type_2 {.tabset}

* value = "-8888" in cas04

## dist_year_2 {.tabset}

* value = -8888 in cas04

## dist_ext_upper_1, dist_ext_lower_1 {.tabset}

* value = -8888 in cas04

## dist_type_3 {.tabset}

* value = ""-8888" in cas04

## dist_year_3 {.tabset}

* value = -8888 in cas04

## dist_ext_upper_1, dist_ext_lower_1 {.tabset}

* value = -8888 in cas04

## layer {.tabset}

  * Should layer summarize entire table or just records with DST information?

```{r echo=TRUE, message=FALSE, warning=FALSE}  
y = mutate(y, layer=case_when(
  #!dist_type_1=="NULL_VALUE" & lyr==1 ~ 1,
  !dist_type_1=="NULL_VALUE" & lyr==2 ~ 2,
  TRUE ~ -8888
  ))
```

### RAWFRI

### CASFRI

```{r echo=FALSE, message=FALSE, warning=FALSE}  
dfSummary(y["layer"], graph.col=FALSE, max.distinct.values=99)
```
